<!DOCTYPE html>
<html>

<head>

  <script>


  /* M O D E   S E L E C T O R S */ // if using `URL` please use Ad server's replace token
  // action for red button [ "image" | "video" | `URL` ]
  redButtonMode = "image";
  // action for green button [ "image" | "video" | `URL` ]
  greenButtonMode = "video";
  // whot should happen when video ended ["loop" | "close" | "image" | `URL` ]
  videoEnd = "https://www.google.rs/search?q=the+end&oq=the+end&gs_l=psy-ab.3..0l4.3634.4927.0.5106.7.7.0.0.0.0.78.498.7.7.0....0...1.1.64.psy-ab..0.7.496...0i46i67k1j46i67k1.pxVTS73t33I";
  // if "image" mode is in use :: clicUrl [`url` | false]
  imageClick = "https://www.google.rs/search?biw=1920&bih=990&q=click+on+image&oq=click+on+image&gs_l=psy-ab.3..0l4.3010.5722.0.5901.14.14.0.0.0.0.92.967.14.14.0....0...1.1.64.psy-ab..0.14.965...0i67k1.KqSPQOJ4504";


  /* C O N T E N T */
  // base url path of remote files ( used due to development )
  var SERVER = "http://ads.diwanee.com/mraid/phone-call/";
  SERVER = ""; // <-- uncoment for local development
  // button to answer the call
  btnGreenImage = SERVER + "assets/img/Iphone/BTN-VERT.png";
  // button to decline the call
  btnRedImage = SERVER + "assets/img/Iphone/BTN-ROUGE.png";
  // content image for landing page
  pageLanding = SERVER + "assets/img/Iphone/TELEPHONE-apple.jpg";
  // content image(s) for image page (Array)
  pageImage = [
    SERVER + "assets/img/Iphone/TELEPHONE-apple10.jpg",
    SERVER + "assets/img/Iphone/TELEPHONE-apple11.jpg",
    SERVER + "assets/img/Iphone/TELEPHONE-apple12.jpg"
  ];
  // video for video page (Array of sources, currently suports only mp4)
  pageVideo = [
	  "http://cdnbakmi.kaltura.com/p/676152/sp/67615200/playManifest/entryId/1_lps4ezfx/flavorId/1_3vgsggr5/format/url/protocol/http/tut_nails_s01e04_pink_and_silver.mp4",
    "http://cdnbakmi.kaltura.com/p/676152/sp/67615200/playManifest/entryId/1_lps4ezfx/flavorId/1_cl2ku40c/format/url/protocol/http/tut_nails_s01e04_pink_and_silver.mp4",
    "http://cdnbakmi.kaltura.com/p/676152/sp/67615200/playManifest/entryId/1_lps4ezfx/flavorId/1_amsp2gd8/format/url/protocol/http/tut_nails_s01e04_pink_and_silver.mp4"
  ]
  // image that contains copirights
  copyright = SERVER + "assets/img/copyright.svg";


  /* U X */
  // how long to showing image before show next  (if multiple images are used)
  faderInterval = 2000; // ms
  // animations
  animGreen = "anim-scale";


  </script>

  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Phone Call Creative</title>

  <script src="mraid.js"></script>

  <script>
  if(location.hash==="#desk"){
    mraid = {};
    mraid.getState = function(){return "loaded";};
    mraid.useCustomClose = function(){};
    mraid.open = function(url){window.open(url);};
    mraid.setOrientationProperties = function(){};
    mraid.close = function(){
      var adWrap = document.getElementById('ad-wrap');
      adWrap.style.display = "none";
      document.body.style.backgroundColor = "blue"
    }
  }
  </script>

  <style>
  * {
    box-sizing: border-box;
    text-align: center;
    font-family: sans-serif;
  }
  html {
    height: 100%;
    width: 100%;
  }
  body {
    height: 100%;
    width: 100%;
    margin: 0;
    padding: 0;
  }
  .centerx {
    -ms-transform: translateX(-50%); /* IE 9 */
    -webkit-transform: translateX(-50%); /* Safari */
    transform: translateX(-50%);
    position: absolute;
    left: 50%;
  }
  .center {
    -ms-transform: translate(-50%, -50%); /* IE 9 */
    -webkit-transform: translate(-50%, -50%); /* Safari */
    transform: translate(-50%, -50%);
    position: absolute;
    left: 50%;
    top: 50%;
  }
  #ad-wrap {
    position: relative;
    width: 100%;
    height: 100%;
  }
  .button {
    position: absolute;
    bottom: 3rem;
    width: 50%;
    text-align: center;
  }
  .button .bimg {
    width: 5rem;
    height: 5rem;
  }
  #green {
    left: 0;
  }
  #red {
    right: 0;
  }
  .full {
    width: 100%;
    height: 100%;
    position: relative;
    overflow: hidden;
  }
  .tapet {
    width: 100%;
    height: 100%;
    background-size: cover;
    background-repeat: no-repeat;
    background-position: center;
  }
  #page-home {
  }
  #page-image {
    display: none;
  }
  #page-video {
    display: none;
  }
  #fader .tapet {
    position: absolute;
    opacity: 0;
    z-index: 0;
    -webkit-transition: opacity 1s ease-in-out; /* Safari */
    transition: opacity 1s ease-in-out;
  }
  #copyright {
    position: absolute;
    left: .3rem;
    bottom: .3rem;
    width: 130px;
    z-index: 10;
  }
  #video {
    width: 100%;
    height: 100%;
  }
  .anim-scale {
    -webkit-animation: anim-scale 1s infinite;
    -moz-animation:    anim-scale 1s infinite;
    -o-animation:      anim-scale 1s infinite;
    animation:         anim-scale 1s infinite;
  }
  @keyframes anim-scale {
    0%, 100% {
      -ms-transform: scale(0.98, 0.98); /* IE 9 */
      -webkit-transform: scale(0.98, 0.98); /* Safari */
      transform: scale(0.98, 0.98);
    }
    50% {
      -ms-transform: scale(1.02, 1.02); /* IE 9 */
      -webkit-transform: scale(1.02, 1.02); /* Safari */
      transform: scale(1.02, 1.02);
    }
  }
  </style>

</head>

<body>

  <div id="ad-wrap"></div>

  <script>

  (function(){

    //
    // T E M P L A T E S
    //

    var tplPageHome = function(){
      var html = "";
      html += '<div id="page-home" class="full">';
      html += " <div class='tapet' style='background-image:url("+ pageLanding +");'></div>";
      html += ' <div id="green" class="button">';
      html += "  <img id='bgreen' class='bimg "+ ((!!window.animGreen) ? animGreen : '') +"' src='"+ btnGreenImage +"'>";
      html += ' </div>';
      html += ' <div id="red" class="button">';
      html += "  <img id='bred' class='bimg' src='"+ btnRedImage +"'>";
      html += ' </div>';
      html += '</div>';
      return html;
    }

    var tplPageImage = function(){
      var html = "";
      html += '<div id="page-image" class="full">';
      html += "<div id='fader' class='full'>";
      for (var sl=0; sl < pageImage.length; sl++ ) {
        html += "<div class='tapet' style='background-image:url("+ pageImage[sl] +");'></div>";
      }
      html += "</div>"
      html += '</div>';
      return html;
    }

    var tplPageVideo = function(){
      var html = "";
      html += '<div id="page-video" class="full">';
      html += "<div id='fader' class='full'>";
      html += "<video id='video'>";
        for (var vsrc=0; vsrc < pageVideo.length; vsrc++) {
          html += "<source src='" + pageVideo[vsrc] + "' type='video/mp4'>";
        }
      html += "</video>";

      html += "</div>"
      html += '</div>';
      return html;
    }

    var tplLayout = function(){
      var html = "";
      html += tplPageHome();
      if (redButtonMode === "image" || greenButtonMode === "image" || videoEnd === "image") {
        html += tplPageImage();
      }
      if (redButtonMode === "video" || greenButtonMode === "video") {
        html += tplPageVideo();
      }
      html += "<img id='copyright' src='"+ copyright +"'>";
      return html;
    }

    document.getElementById("ad-wrap").innerHTML = tplLayout();

    //
    // A C T I O N S
    //

    var preloadImg = {};
    for (var sl=0; sl < pageImage.length; sl++ ) { // preload all images for better UX
      preloadImg[sl] = new Image();
      preloadImg[sl].src = pageImage[sl];
    }
    var runSlider = function(){
      var slides = document.getElementById('fader').childNodes;
      slides[0].style.opacity = 1;
      if (!!slides[1]) {
        setInterval(function(){
          for(var si = 0; si < slides.length; si++){
            if (slides[si].style.opacity === '1'){
              if (!!slides[si+1]){
                setTimeout(function(){
                  slides[si].style.opacity = 0;
                }, faderInterval/2);
                slides[si].style.zIndex = 0;
                slides[si+1].style.opacity = 1;
                slides[si+1].style.zIndex = 1;
              }
              else {
                setTimeout(function(){
                  slides[si].style.opacity = 0;
                }, faderInterval/2);
                slides[si].style.zIndex = 0;
                slides[0].style.opacity = 1;
                slides[0].style.zIndex = 1;
              }
              break;
            }
          }
        }, faderInterval);
      }
      if (imageClick) {
        document.getElementById('page-image').addEventListener('click', function() {
          mraid.open(imageClick);
        });
      }
      runSlider = function(){};
    }

    var runVideo = function(){
      var video = document.getElementById('video');
      switch (videoEnd) {
        case "loop":
          video.loop = true;
          break;
        case "close":
          video.onended = function() {
            mraid.close();
          }
          break;
        case "image":
          video.onended = function() {
            document.getElementById('page-video').style.display = 'none';
            document.getElementById('page-image').style.display = 'block';
            runSlider();
          }
          break;
        default:
          video.onended = function() {
            mraid.open(videoEnd);
          }
      }
      video.play();
      runVideo = function(){};
    }

    //
    // B I N D I N G S
    //

    function showMRAIDAd() {

      document.addEventListener('touchmove', function(e) {
        e.preventDefault();
      });

      mraid.useCustomClose(false);

      document.getElementById('bred').addEventListener('click', function() {
        switch (redButtonMode) {
          case "image":
            document.getElementById('page-home').style.display = 'none';
            document.getElementById('page-image').style.display = 'block';
            runSlider();
            break;
          case "video":
            document.getElementById('page-home').style.display = 'none';
            document.getElementById('page-video').style.display = 'block';
            runVideo();
            break;
          case "close":
            mraid.close();
            break;
          default: // `URL`
            mraid.open(redButtonMode);
        }
      });

      document.getElementById('bgreen').addEventListener('click', function() {
        switch (greenButtonMode) {
          case "image":
            document.getElementById('page-home').style.display = 'none';
            document.getElementById('page-image').style.display = 'block';
            runSlider();
            break;
          case "video":
            document.getElementById('page-home').style.display = 'none';
            document.getElementById('page-video').style.display = 'block';
            runVideo();
            break;
          case "close":
            mraid.close();
            break;
          default: // `URL`
            mraid.open(greenButtonMode);
        }
      });

    }

    //
    // M R A I D
    //

    mraid.setOrientationProperties({
      //"allowOrientationChange" : false,
      "forceOrientation" : "portrait"
    });

    if (mraid.getState() === 'loading') {
      mraid.addEventListener('ready', showMRAIDAd);
    } else {
      showMRAIDAd();
    }

  })();
  </script>

</body>

</html>
